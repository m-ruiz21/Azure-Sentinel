{
  "name": "QualysKBDCR",
  "apiVersion": "2023-03-11",
  "type": "Microsoft.Insights/dataCollectionRules",
  "location": "{{location}}",
  "properties": {
    "description": "Data Collection Rule for Qualys KB vulnerability data ingestion",
    "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
    "streamDeclarations": {
      "Custom-QualysKB": { 
        "columns": [
          {
            "name": "QID",
            "type": "string"
          },
          {
            "name": "TITLE",
            "type": "string"
          },
          {
            "name": "CATEGORY",
            "type": "string"
          },
          {
            "name": "CONSEQUENCE",
            "type": "dynamic"
          },
          {
            "name": "DIAGNOSIS",
            "type": "dynamic"
          },
          {
            "name": "SOLUTION",
            "type": "dynamic"
          },
          {
            "name": "LAST_SERVICE_MODIFICATION_DATETIME",
            "type": "string"
          },
          {
            "name": "PATCHABLE",
            "type": "string"
          },
          {
            "name": "CVE_LIST",
            "type": "dynamic"
          },
          {
            "name": "VENDOR_REFERENCE_LIST",
            "type": "dynamic"
          },
          {
            "name": "PCI_FLAG",
            "type": "string"
          },
          {
            "name": "PUBLISHED_DATETIME",
            "type": "string"
          },
          {
            "name": "SEVERITY_LEVEL",
            "type": "string"
          },
          {
            "name": "SOFTWARE_LIST",
            "type": "dynamic"
          },
          {
            "name": "VULN_TYPE",
            "type": "string"
          },
          {
            "name": "DISCOVERY",
            "type": "dynamic"
          },
          {
            "name": "THREAT_INTELLIGENCE",
            "type": "dynamic"
          }
        ]
      }
    },
    "destinations": {
      "logAnalytics": [
        {
          "workspaceResourceId": "{{workspaceResourceId}}",
          "name": "clv2ws1"
        }
      ]
    },
    "dataFlows": [
      {
        "streams": ["Custom-QualysKB"],
        "destinations": ["clv2ws1"],
        "outputStream": "Custom-QualysKB_CL"
      }
    ]
  }
}